<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì„œì‚° ì´ìŠˆ - API í…ŒìŠ¤íŠ¸</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            color: white;
            text-align: center;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .api-section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .api-section h2 {
            color: #667eea;
            margin-bottom: 15px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .test-group {
            margin-bottom: 15px;
        }

        .test-group h3 {
            color: #555;
            font-size: 16px;
            margin-bottom: 8px;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 10px;
            margin-bottom: 10px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        button:active {
            transform: translateY(0);
        }

        .result {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin-top: 10px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .result.success {
            border-left-color: #28a745;
            background: #d4edda;
        }

        .result.error {
            border-left-color: #dc3545;
            background: #f8d7da;
        }

        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }

        .status.success {
            background: #28a745;
            color: white;
        }

        .status.error {
            background: #dc3545;
            color: white;
        }

        .clear-btn {
            background: #6c757d;
            float: right;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ ì„œì‚° ì´ìŠˆ API í…ŒìŠ¤íŠ¸ í˜ì´ì§€</h1>

        <!-- ê²Œì‹œê¸€ API -->
        <div class="api-section">
            <h2>ğŸ“ ê²Œì‹œê¸€ API (/api/posts)</h2>
            <div class="test-group">
                <h3>ì¹´í…Œê³ ë¦¬ë³„ ì¡°íšŒ</h3>
                <button onclick="testAPI('/api/posts?category=WELFARE_SENIOR&page=0&size=5', 'posts-category')">ë³µì§€-ì–´ë¥´ì‹ </button>
                <button onclick="testAPI('/api/posts?category=NOTICE&page=0&size=5', 'posts-category')">ê³µì§€ì‚¬í•­</button>
                <button onclick="testAPI('/api/posts?category=CULTURE_NEWS&page=0&size=5', 'posts-category')">ë¬¸í™”ì†Œì‹</button>
                <button class="clear-btn" onclick="clearResult('posts-category')">ê²°ê³¼ ì§€ìš°ê¸°</button>
                <div id="posts-category"></div>
            </div>

            <div class="test-group">
                <h3>ì§€ì—­ë³„ ì¡°íšŒ</h3>
                <button onclick="testAPI('/api/posts?region=ëŒ€ì‚°ì&page=0&size=5', 'posts-region')">ëŒ€ì‚°ì</button>
                <button onclick="testAPI('/api/posts?region=í•´ë¯¸ë©´&page=0&size=5', 'posts-region')">í•´ë¯¸ë©´</button>
                <button onclick="testAPI('/api/posts?region=ì„œì‚°ì‹œ ì „ì²´&page=0&size=5', 'posts-region')">ì„œì‚°ì‹œ ì „ì²´</button>
                <button class="clear-btn" onclick="clearResult('posts-region')">ê²°ê³¼ ì§€ìš°ê¸°</button>
                <div id="posts-region"></div>
            </div>
        </div>

        <!-- ë‚ ì”¨ API -->
        <div class="api-section">
            <h2>ğŸŒ¤ï¸ ë‚ ì”¨ API (/api/v1/weather)</h2>
            <div class="test-group">
                <h3>ì§€ì—­ë³„ ë‚ ì”¨ (ì´ˆë‹¨ê¸°ì‹¤í™©)</h3>
                <button onclick="testAPI('/api/v1/weather/ncst?region=ëŒ€ì‚°ì', 'weather')">ëŒ€ì‚°ì</button>
                <button onclick="testAPI('/api/v1/weather/ncst?region=í•´ë¯¸ë©´', 'weather')">í•´ë¯¸ë©´</button>
                <button onclick="testAPI('/api/v1/weather/ncst?city=ì„œì‚°ì‹œ', 'weather')">ì„œì‚°ì‹œ ì „ì²´</button>
                <button class="clear-btn" onclick="clearResult('weather')">ê²°ê³¼ ì§€ìš°ê¸°</button>
                <div id="weather"></div>
            </div>

            <div class="test-group">
                <h3>ë‚ ì”¨ ì˜ˆë³´ (ì´ˆë‹¨ê¸°ì˜ˆë³´)</h3>
                <button onclick="testAPI('/api/v1/weather/fcst?region=ëŒ€ì‚°ì', 'weather-fcst')">ëŒ€ì‚°ì ì˜ˆë³´</button>
                <button onclick="testAPI('/api/v1/weather/fcst?region=í•´ë¯¸ë©´', 'weather-fcst')">í•´ë¯¸ë©´ ì˜ˆë³´</button>
                <button class="clear-btn" onclick="clearResult('weather-fcst')">ê²°ê³¼ ì§€ìš°ê¸°</button>
                <div id="weather-fcst"></div>
            </div>
        </div>

        <!-- ë„¤ì´ë²„ ê²€ìƒ‰ API -->
        <div class="api-section">
            <h2>ğŸ” ë„¤ì´ë²„ ê²€ìƒ‰ API (/api/v1/explore)</h2>
            <div class="test-group">
                <h3>í†µí•© ê²€ìƒ‰</h3>
                <button onclick="testAPI('/api/v1/explore/naver?q=ì„œì‚°ì‹œ&types=news&display=3', 'naver-search')">ë‰´ìŠ¤</button>
                <button onclick="testAPI('/api/v1/explore/naver?q=ì„œì‚°ì‹œ&types=blog&display=3', 'naver-search')">ë¸”ë¡œê·¸</button>
                <button onclick="testAPI('/api/v1/explore/naver?q=ì„œì‚°ì‹œ&types=cafearticle&display=3', 'naver-search')">ì¹´í˜</button>
                <button onclick="testAPI('/api/v1/explore/naver?q=ì„œì‚°ì‹œ&types=news,blog,cafearticle&display=2', 'naver-search')">í†µí•©</button>
                <button class="clear-btn" onclick="clearResult('naver-search')">ê²°ê³¼ ì§€ìš°ê¸°</button>
                <div id="naver-search"></div>
            </div>
        </div>

        <!-- AI ê²€ìƒ‰ API -->
        <div class="api-section">
            <h2>ğŸ¤– AI ê²€ìƒ‰ API (/api/v1/ai-search)</h2>
            <div class="test-group">
                <h3>AI ê²€ìƒ‰ (One-Shot)</h3>
                <button onclick="testAISearch('ì„œì‚°ì‹œ ìµœê·¼ ì´ìŠˆëŠ”?', 'ai-search')">ì„œì‚°ì‹œ ì´ìŠˆ</button>
                <button onclick="testAISearch('ëŒ€ì‚°ì ë³µì§€ ì •ë³´', 'ai-search')">ëŒ€ì‚°ì ë³µì§€</button>
                <button onclick="testAISearch('ì„œì‚°ì‹œ ë‚ ì”¨', 'ai-search')">ì„œì‚°ì‹œ ë‚ ì”¨</button>
                <button class="clear-btn" onclick="clearResult('ai-search')">ê²°ê³¼ ì§€ìš°ê¸°</button>
                <div id="ai-search"></div>
            </div>

            <div class="test-group">
                <h3>AI ìƒì„¸ ê²€ìƒ‰ (Map-Reduce)</h3>
                <button onclick="testAISearchDetail('ì„œì‚°ì‹œ êµí†µ ì •ë³´', 'ai-detail')">êµí†µ ì •ë³´</button>
                <button onclick="testAISearchDetail('ì„œì‚°ì‹œ ë¬¸í™” í–‰ì‚¬', 'ai-detail')">ë¬¸í™” í–‰ì‚¬</button>
                <button class="clear-btn" onclick="clearResult('ai-detail')">ê²°ê³¼ ì§€ìš°ê¸°</button>
                <div id="ai-detail"></div>
            </div>
        </div>

        <!-- Flask API -->
        <div class="api-section">
            <h2>ğŸ Flask API (/flask)</h2>
            <div class="test-group">
                <h3>í¬ë¡¤ëŸ¬ & í†µê³„</h3>
                <button onclick="testAPI('/flask/content_stats', 'flask')">ì½˜í…ì¸  í†µê³„</button>
                <button onclick="testAPI('/flask/crawl_popular_terms', 'flask')">ì¸ê¸° ê²€ìƒ‰ì–´</button>
                <button class="clear-btn" onclick="clearResult('flask')">ê²°ê³¼ ì§€ìš°ê¸°</button>
                <div id="flask"></div>
            </div>

            <div class="test-group">
                <h3>í…ìŠ¤íŠ¸ ìš”ì•½ (BART)</h3>
                <button onclick="testSummarize('flask-summarize')">ìƒ˜í”Œ í…ìŠ¤íŠ¸ ìš”ì•½</button>
                <button class="clear-btn" onclick="clearResult('flask-summarize')">ê²°ê³¼ ì§€ìš°ê¸°</button>
                <div id="flask-summarize"></div>
            </div>
        </div>
    </div>

    <script>
        async function testAPI(url, resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.innerHTML = '<div class="result">â³ ìš”ì²­ ì¤‘...</div>';

            const startTime = Date.now();

            try {
                console.log('ğŸ”µ API ìš”ì²­:', url);
                const response = await fetch(url);
                const responseTime = Date.now() - startTime;

                const contentType = response.headers.get('content-type');
                console.log('ğŸ“¥ ì‘ë‹µ:', response.status, contentType);

                let data;
                if (contentType && contentType.includes('application/json')) {
                    data = await response.json();
                } else {
                    const text = await response.text();
                    data = { error: 'JSONì´ ì•„ë‹Œ ì‘ë‹µ', contentType, preview: text.substring(0, 200) };
                }

                const statusClass = response.ok ? 'success' : 'error';
                const statusText = response.ok ? 'âœ… ì„±ê³µ' : 'âŒ ì‹¤íŒ¨';

                resultDiv.innerHTML = `
                    <div class="result ${statusClass}">
                        <strong>${url}</strong>
                        <span class="status ${statusClass}">${response.status} ${response.statusText}</span>
                        <span class="status success">${responseTime}ms</span>
                        <hr style="margin: 10px 0; border: none; border-top: 1px solid #ddd;">
                        ${JSON.stringify(data, null, 2)}
                    </div>
                `;

                console.log('âœ… ì‘ë‹µ ë°ì´í„°:', data);
            } catch (error) {
                const responseTime = Date.now() - startTime;
                console.error('âŒ ì—ëŸ¬:', error);
                resultDiv.innerHTML = `
                    <div class="result error">
                        <strong>${url}</strong>
                        <span class="status error">ERROR</span>
                        <span class="status success">${responseTime}ms</span>
                        <hr style="margin: 10px 0; border: none; border-top: 1px solid #ddd;">
                        ${error.message}
                    </div>
                `;
            }
        }

        async function testAISearch(query, resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.innerHTML = '<div class="result">â³ AI ê²€ìƒ‰ ì¤‘...</div>';

            const startTime = Date.now();

            try {
                const response = await fetch('/api/v1/ai-search', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ query, maxExternal: 3 })
                });

                const responseTime = Date.now() - startTime;
                const data = await response.json();

                const statusClass = response.ok ? 'success' : 'error';

                resultDiv.innerHTML = `
                    <div class="result ${statusClass}">
                        <strong>POST /api/v1/ai-search</strong>
                        <span class="status ${statusClass}">${response.status}</span>
                        <span class="status success">${responseTime}ms</span>
                        <hr style="margin: 10px 0; border: none; border-top: 1px solid #ddd;">
                        <strong>ì¿¼ë¦¬:</strong> ${query}
                        <hr style="margin: 10px 0; border: none; border-top: 1px solid #ddd;">
                        ${JSON.stringify(data, null, 2)}
                    </div>
                `;
            } catch (error) {
                const responseTime = Date.now() - startTime;
                resultDiv.innerHTML = `
                    <div class="result error">
                        <strong>POST /api/v1/ai-search</strong>
                        <span class="status error">ERROR</span>
                        <span class="status success">${responseTime}ms</span>
                        <hr style="margin: 10px 0; border: none; border-top: 1px solid #ddd;">
                        ${error.message}
                    </div>
                `;
            }
        }

        async function testAISearchDetail(query, resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.innerHTML = '<div class="result">â³ AI ìƒì„¸ ê²€ìƒ‰ ì¤‘ (ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤)...</div>';

            const startTime = Date.now();

            try {
                const response = await fetch('/api/v1/ai-search/detail', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ query, maxExternal: 3 })
                });

                const responseTime = Date.now() - startTime;
                const data = await response.json();

                const statusClass = response.ok ? 'success' : 'error';

                resultDiv.innerHTML = `
                    <div class="result ${statusClass}">
                        <strong>POST /api/v1/ai-search/detail</strong>
                        <span class="status ${statusClass}">${response.status}</span>
                        <span class="status success">${responseTime}ms</span>
                        <hr style="margin: 10px 0; border: none; border-top: 1px solid #ddd;">
                        <strong>ì¿¼ë¦¬:</strong> ${query}
                        <hr style="margin: 10px 0; border: none; border-top: 1px solid #ddd;">
                        ${JSON.stringify(data, null, 2)}
                    </div>
                `;
            } catch (error) {
                const responseTime = Date.now() - startTime;
                resultDiv.innerHTML = `
                    <div class="result error">
                        <strong>POST /api/v1/ai-search/detail</strong>
                        <span class="status error">ERROR</span>
                        <span class="status success">${responseTime}ms</span>
                        <hr style="margin: 10px 0; border: none; border-top: 1px solid #ddd;">
                        ${error.message}
                    </div>
                `;
            }
        }

        async function testSummarize(resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.innerHTML = '<div class="result">â³ í…ìŠ¤íŠ¸ ìš”ì•½ ì¤‘...</div>';

            const sampleText = "ì„œì‚°ì‹œëŠ” ì¶©ì²­ë‚¨ë„ ì„œë¶ë¶€ì— ìœ„ì¹˜í•œ ë„ì‹œë¡œ, í•´ë¯¸ìì„±ê³¼ ê°™ì€ ì—­ì‚¬ì  ëª…ì†Œê°€ ìˆìŠµë‹ˆë‹¤. ìµœê·¼ ì„œì‚°ì‹œëŠ” ìŠ¤ë§ˆíŠ¸ ë„ì‹œ êµ¬ì¶•ì„ ìœ„í•´ ë‹¤ì–‘í•œ ì‚¬ì—…ì„ ì¶”ì§„í•˜ê³  ìˆìœ¼ë©°, ì£¼ë¯¼ë“¤ì˜ í¸ì˜ë¥¼ ìœ„í•œ ë³µì§€ ì •ì±…ë„ ê°•í™”í•˜ê³  ìˆìŠµë‹ˆë‹¤. ë˜í•œ ëŒ€ì‚°ìì€ ì„ìœ í™”í•™ë‹¨ì§€ë¡œ ìœ ëª…í•˜ë©°, ì§€ì—­ ê²½ì œì— í° ê¸°ì—¬ë¥¼ í•˜ê³  ìˆìŠµë‹ˆë‹¤.";

            const startTime = Date.now();

            try {
                const response = await fetch('/flask/summarize', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text: sampleText })
                });

                const responseTime = Date.now() - startTime;
                const data = await response.json();

                const statusClass = response.ok ? 'success' : 'error';

                resultDiv.innerHTML = `
                    <div class="result ${statusClass}">
                        <strong>POST /flask/summarize</strong>
                        <span class="status ${statusClass}">${response.status}</span>
                        <span class="status success">${responseTime}ms</span>
                        <hr style="margin: 10px 0; border: none; border-top: 1px solid #ddd;">
                        <strong>ì›ë³¸:</strong> ${sampleText}
                        <hr style="margin: 10px 0; border: none; border-top: 1px solid #ddd;">
                        ${JSON.stringify(data, null, 2)}
                    </div>
                `;
            } catch (error) {
                const responseTime = Date.now() - startTime;
                resultDiv.innerHTML = `
                    <div class="result error">
                        <strong>POST /flask/summarize</strong>
                        <span class="status error">ERROR</span>
                        <span class="status success">${responseTime}ms</span>
                        <hr style="margin: 10px 0; border: none; border-top: 1px solid #ddd;">
                        ${error.message}
                    </div>
                `;
            }
        }

        function clearResult(resultId) {
            document.getElementById(resultId).innerHTML = '';
        }
    </script>
</body>
</html>

